# Linux命令

## 1 用户相关

~~~
新建用户
useradd zhufukun
#修改密码
passwd zhufukun
删除用户
userdel xiaoke(用户名)：表示删除xiaoke用户，但不会自动删除用户的主目录。 
userdel -r xiaoke(用户名)：表示删除用户，同时删除用户的主目录。

查询用户所属组
groups zhufukun
groups

#查询组
cat /etc/groups 
内容：用户组（Group）、用户组口令、GID 、用户组所包含的用户（User）

#新建组
groupadd zfk
修改用户所属组
usermod -g zfk zhufukun
#新建用户到zfk组
useradd zhufukun -g zfk

#为创建的普通用户添加sudo权限
格式一：usermod -a -G adm 用户名 
格式二：usermod -a -G sudo 用户名

~~~



## 2 进程相关

~~~
查进程得到PID：ps -ef|grep java
结束进程：kill -9 PID
根据进程号查看对应的信息，比如端口
netstat -anop|grep PID

查看端口
netstat -apltu|grep 8080

Linux查看CPU和内存使用情况
top

~~~





## 3  环境变量

~~~
查看环境变量
printevn

/ect/profile
~/.bash_profile
~~~



## 4 网络配置

```
默认安装好之后是没有自动开启网络连接的
ifconfig 安装
sudo apt install net-tools
```

```
查看IP
ifconfig
查看路由网关
route

重启网络服务
service network restart

通过下面命令即可临时设置IP地址。
ifconfig  设备名 IP 地址 (ifconfig eth0  192.168.1.117)
```

```
网络接口命名
	eth0:	ethernet 以太网接口
	wifi0: 无线局域网  无线网络接口
	ath0: Atheros 指Atheros芯片所包含的无线网络接口
	lo: local 简写， 本地环回接口

[root@localhost ~]# vim /etc/sysconfig/network-scripts/ifcfg-eth0（ifcfg-ens32）
TYPE=Ethernet
BOOTPROTO=static # dhcp
DEFROUTE=yes
PEERDNS=yes
PEERROUTES=yes
IPV4_FAILURE_FATAL=no
IPV6INIT=yes
IPV6_AUTOCONF=yes
IPV6_DEFROUTE=yes
IPV6_PEERDNS=yes
IPV6_PEERROUTES=yes
IPV6_FAILURE_FATAL=no
IPV6_ADDR_GEN_MODE=stable-privacy
NAME=enp2s0
UUID=b43a3c76-cf79-4ec7-b4dc-0e424d1f0098
DEVICE=enp2s0
ONBOOT=yes

IPADDR0=192.168.1.200
NETMASK=255.255.255.0
GATEWAY=192.168.1.1
```



## 5 防火墙（CentOS7）

~~~
可以通过查询防火墙的当前状态来确定服务器是否开启了防火墙
firewall-cmd --state
如果终端输出running就表示防火墙已经开启了，反之就没有。
也可以使用下面的命令来查询
systemctl status firewalld

启动防火墙
当得知防火墙没有被开启时，就需要手动将其开启。
systemctl start firewalld
执行上述命令后，是没有任何输出信息的。没有提示信息对我们来说就是个好消息，说明我们的防火墙起来了。

查看已经开放的端口
许多情况下是需要查看服务器是否开启了端口的。比如我添加了一个站点，用的端口是8080，在服务器能正常访问，但是外面却访问不了，这个时候的第一反应应该就是防火墙的8080端口还没有对外开放。
firewall-cmd --list-ports

添加新端口
只添加一个单独的端口(示例为81)
firewall-cmd --zone=public --add-port=81/tcp --permanent
添加一组连续的端口(示例为82到85)
firewall-cmd --zone=public --add-port=82-85/tcp --permanent
#此时我们应该要重新启动防火墙，让其生效。
firewall-cmd --reload
查看已经开放的端口
firewall-cmd --list-ports

通过zones下面的xml文件来查看
在 /etc/firewall/zones 目录下面有一个名为public.xml的文件。这里存放着这个zone相关的信息，不只是端口！
cat /etc/firewall/zones/public.xml

查询指定的端口是否已经开放
firewall-cmd --zone=public --query-port=81/tcp

关闭端口
firewall-cmd --zone=public --remove-port=81/tcp --permanent
同样的，关闭端口之后也是要重启才能生效。

关闭防火墙
systemctl stop firewalld.service
~~~

~~~
1、firewalld的基本使用
启动： systemctl start firewalld
关闭： systemctl stop firewalld
查看状态： systemctl status firewalld 
开机禁用  ： systemctl disable firewalld
开机启用  ： systemctl enable firewalld

2.systemctl是CentOS7的服务管理工具中主要的工具，它融合之前service和chkconfig的功能于一体。
启动一个服务：systemctl start firewalld.service
关闭一个服务：systemctl stop firewalld.service
重启一个服务：systemctl restart firewalld.service
显示一个服务的状态：systemctl status firewalld.service
在开机时启用一个服务：systemctl enable firewalld.service
在开机时禁用一个服务：systemctl disable firewalld.service
查看服务是否开机启动：systemctl is-enabled firewalld.service
查看已启动的服务列表：systemctl list-unit-files|grep enabled
查看启动失败的服务列表：systemctl --failed

3.配置firewalld-cmd
查看版本： firewall-cmd --version
查看帮助： firewall-cmd --help
显示状态： firewall-cmd --state
查看所有打开的端口： firewall-cmd --zone=public --list-ports
更新防火墙规则： firewall-cmd --reload
查看区域信息:  firewall-cmd --get-active-zones
查看指定接口所属区域： firewall-cmd --get-zone-of-interface=eth0
拒绝所有包：firewall-cmd --panic-on
取消拒绝状态： firewall-cmd --panic-off
查看是否拒绝： firewall-cmd --query-panic
 
那怎么开启一个端口呢
添加
firewall-cmd --zone=public --add-port=80/tcp --permanent    （--permanent永久生效，没有此参数重启后失效）
重新载入
firewall-cmd --reload
查看
firewall-cmd --zone= public --query-port=80/tcp
删除
firewall-cmd --zone= public --remove-port=80/tcp --permanent
~~~



##  文件相关

~~~
查看文件 ll, ls

新建文件
touch a.txt
新建文件夹
mkdir newDir

查看文件
cat 文件

编辑文件
vim 文件
:q退出
按i编辑
按Esc退出编辑
按v高亮选择文本，按y复制文本，按p粘贴文本
按/查找文本，按n下一个
:q!取消修改退出
:wq保存修改退出
:q将文件保存到另一个文件

复制文件
cp 原文件 目标文件
复制目录
cp 原目录 -R 目标目录

修改文件名或目录名
mv a.txt newFile.txt

删除文件
rm 文件名
删除目录 命令不能直接删除非空目录
rmdir 目录

#远程文件复制
ssh 用户@IP
ssh oracle@192.168.74.128

scp -r local_folder remote_username@remote_ip:remote_folder
scp authorized_keys_Master1 hadoop@192.168.4.202:/home/hadoop/.ssh/

从 本地 复制到 远程 
scp  -rp  /path/filename  username@remoteIP:/path
scp /home/daisy/full.tar.gz root@172.19.2.75:/home/root （然后会提示你输入另外那台172.19.2.75主机的root用户的登录密码，接着就开始copy了），复制目录加参数 -r 即可

从 远程 复制到 本地 
scp  -rp  username@remoteIP:/path/filename  /path
scp root@/172.19.2.75:/home/root/full.tar.gz /home/daisy/full.tar.gz


1.如果远程服务器防火墙有特殊限制，scp便要走特殊端口，具体用什么端口视情况而定，命令格式如下：
#scp -p 4588 remote@www.abc.com:/usr/local/sin.sh /home/administrator

windows路径
administrator@127.0.0.1:/D:/

从linux系统复制文件到windows系统：scp /oracle/a.txt  administrator@192.168.3.181:/d:/

在linux环境下，将windows下的文件复制到linux系统中：scp administrator@192.168.3.181:/d:/test/config.ips  /oracle

请注意：因为windows系统本身不支持ssh协议，所以，要想上面的命令成功执行，必须在windows客户端安装ssh for windows的客户端软件，比如winsshd，使windows系统支持ssh协议才行。

~~~



## 文件权限

~~~
文件权限
ll newFile.txt
-rw-rw-r-- 1 zhufukun zhufukun 0 6月   4 17:52 newFile.txt
#r读（代号：4） ，w写（代号：2），x执行（代号：1），-：不具有任何权限（代号：0），第1位粘着位，第2-4位属主，第5-7位属组，第8-10其他用户

#修改文件权限
chmod 774 newFile.txt
ll newFile.txt
-rwxrwxr-- 1 zhufukun zhufukun 0 6月   4 18:15 newFile.txt*

#修改目录权限
Chmod 774 -R file

#修改文件所有者
Chown zhufukun -R tomcat

#修改文件所属组
Chgrp -R zfk tomcat
~~~





## 下载安装命令

~~~
#下载安装包
wget http://nginx.org/download/nginx-1.11.3.tar.gz
#yum可以用于运作rpm包，例如在Centos系统上对某个软件的管理：
安装：yum install <package_name> 
卸载：yum remove <package_name> 
更新：yum update <package_name>
#apt-get可以用于运作deb包，例如在Ubuntu系统上对某个软件的管理：
安装：apt-get install <package_name> 
卸载：apt-get remove <package_name> 
更新：apt-get update <package_name>
~~~





# 	centos7  测试服务器配置

sshpass -p Szzx20170830 ssh root@192.168.1.200

```
用户			    密码
root         123456
useradd zhufukun
passwd 123456
```



## JDK安装

~~~java
解压 jdk-8u131-linux-x64.tar.gz安装包
[root@localhost zhufukun]# mkdir /usr/java
[root@localhost zhufukun]# tar -zxvf jdk-8u131-linux-x64.tar.gz -C/usr/java
5、设置环境变量
[root@localhost zhufukun]# vim /etc/profile
在最前面添加：
export JAVA_HOME=/usr/java/jdk1.8.0_131  
export JRE_HOME=${JAVA_HOME}/jre  
export CLASSPATH=.:{JAVA_HOME}/lib:{JRE_HOME}/lib  
export  PATH={JAVA_HOME}/bin:PATH
6、执行profile文件
[root@localhost zhufukun]# source /etc/profile
这样可以使配置不用重启即可立即生效。
7、检查新安装的jdk
[root@localhost zhufukun]# java -version
显示：
java version "1.8.0_131"
Java(TM) SERuntime Environment (build 1.8.0_131-b11)
Java HotSpot(TM) 64-BitServer VM (build 25.131-b11, mixed mode)

~~~



##  tomcat

~~~
1 打包上传：将项目打包成 war 文件，然后利用传到远程服务器（在Eclipse中直接将项目导出为.war文件）。
2 将 war 文件移动到 Tomcat 目录下的 webapps 下。
3 重启 Tomcat，访问我们的项目。
启动tomcat服务，bin目录下
方式一：直接启动 ./startup.sh
方式二：作为服务启动 nohup ./startup.sh &
方式三：控制台动态输出方式启动 ./catalina.sh run 动态地显示tomcat后台的控制台输出信息,Ctrl+C后退出并关闭服务
解释：
通过方式一、方式三启动的tomcat有个弊端，当客户端连接断开的时候，tomcat服务也会立即停止，通过方式二可以作为linux服务一直运行
通过方式一、方式二方式启动的tomcat，其日志会写到相应的日志文件中，而不能动态地查看tomcat控制台的输出信息与错误情况，通过方式三可以以控制台模式启动tomcat服务，
直接看到程序运行时后台的控制台输出信息，不必每次都要很麻烦的打开catalina.out日志文件进行查看，这样便于跟踪查阅后台输出信息。tomcat控制台信息包括log4j和System.out.println()等输出的信息。

补充：使用命令tail -f xx.log 查看日志
~~~



##  网络配置 

~~~
默认安装好之后是没有自动开启网络连接的
ifconfig 安装
sudo apt install net-tools
~~~

~~~
查看IP
ifconfig
查看路由网关
route

重启网络服务
service network restart

通过下面命令即可临时设置IP地址。
ifconfig  设备名 IP 地址 (ifconfig eth0  192.168.1.117)
~~~

~~~
网络接口命名
	eth0:	ethernet 以太网接口
	wifi0: 无线局域网  无线网络接口
	ath0: Atheros 指Atheros芯片所包含的无线网络接口
	lo: local 简写， 本地环回接口

[root@localhost ~]# vim /etc/sysconfig/network-scripts/ifcfg-eth0（ifcfg-ens32）
TYPE=Ethernet
BOOTPROTO=static # dhcp
DEFROUTE=yes
PEERDNS=yes
PEERROUTES=yes
IPV4_FAILURE_FATAL=no
IPV6INIT=yes
IPV6_AUTOCONF=yes
IPV6_DEFROUTE=yes
IPV6_PEERDNS=yes
IPV6_PEERROUTES=yes
IPV6_FAILURE_FATAL=no
IPV6_ADDR_GEN_MODE=stable-privacy
NAME=enp2s0
UUID=b43a3c76-cf79-4ec7-b4dc-0e424d1f0098
DEVICE=enp2s0
ONBOOT=yes

IPADDR0=192.168.1.200
NETMASK=255.255.255.0
GATEWAY=192.168.1.1
~~~





##  mysql 安装配置

```
安装环境：RedHat6.5 
第一步：下载 
下载MySQL5.7：http://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.12-1.el6.x86_64.rpm-bundle.tar

第二步：安装 
安装前检查服务器是否已安装MySQL，如已安装则将其卸载:
[root@zhufukun tmp]# rpm -qa|grep mysql
mysql-libs-5.1.71-1.el6.x86_64
//卸载
[root@zhufukun tmp]# rpm -e --nodeps mysql-libs-5.1.71-1.el6.x86_64  
将下载的文件进行解压：
[root@zhufukun tmp]# tar -xf mysql-5.7.12-1.el6.x86_64.rpm-bundle.tar
按顺序依次安装：
[root@zhufukun tmp]# rpm -ivh mysql-community-common-5.7.12-1.el6.x86_64.rpm
[root@zhufukun tmp]# rpm -ivh mysql-community-libs-5.7.12-1.el6.x86_64.rpm
[root@zhufukun tmp]# rpm -ivh mysql-community-devel-5.7.12-1.el6.x86_64.rpm
[root@zhufukun tmp]# rpm -ivh mysql-community-client-5.7.12-1.el6.x86_64.rpm
[root@zhufukun tmp]# rpm -ivh mysql-community-server-5.7.12-1.el6.x86_64.rpm

第三步：环境变量设置
1.启动MySQL：service mysqld start 
2.登录：mysql -u root -p，初次登录密码为空，直接回车： 
报错，原因是因为MySQL5.7中的mysql.user 表中没有Password字段，所以要以安全方式登录，然后修改密码。 
解决方法如下： 
//停止MySQL： service mysqld stop
修改MySQL配置文件：vim /etc/my.cnf，在文件末尾加上：skip-grant-tables，保存后重启MySQL服务：service mysqld start，然后重新登录。 
3.修改密码，用户密码是在名为mysql的database下面： 
依次执行以下指令：
mysql> use mysql //切换数据库
//mysql> update user set password_expired='N' where user='root’;    
mysql> update user set authentication_string=password('123456') where user='root';
mysql> flush privileges;
mysql>exit
注意：将my.cnf配置文件之前加的跳过密码检测内容去掉，重启服务；

允许远程访问MySQL：
赋予任何主机访问数据的权限 
mysql>grant all privileges on *.* to 'root'@'%' identified by '123456' with grant option;
mysql> flush privileges;
查看修改是否成功：
select host,user from user;
//如果报错
ERROR 1820 (HY000): You must reset your password using ALTER USER statement before executing this statement.
mysql> set password=password("123");
ERROR 1819 (HY000): Your password does not satisfy the current policy requirements
mysql> set password=password("123456Qq!");
不想限制密码设置的太复杂，更改密码策略：
mysql> set global validate_password_length=0; --更改密码长度
mysql> set global validate_password_policy=0; --更改密码策略为LOW

查看字符集设置是否正确：
mysql> show variables like '%character%';

其他：
编码设置：vim /etc/my.cnf，文件末尾加上编码内容default-character-set=utf8
 

```

## mysql用户操作

```
创建数据库：
create database zfkdb DEFAULT CHARSET utf8 COLLATE utf8_general_ci;  
创建用户能远程访问：
CREATE USER 'zfk'@'%' IDENTIFIED BY '123456'; 
授权：
GRANT SELECT, INSERT , UPDATE, DELETE ON [数据库名称|*].* TO 'zfk'@'%'
授全权
GRANT ALL ON zfkdb.* TO 'zfk'@'%';

```

## 安装gcc

~~~
一. gcc 安装
安装 nginx 需要先将官网下载的源码进行编译，编译依赖 gcc 环境，如果没有 gcc 环境，则需要安装：
#yum install gcc（试下这个）
#yum install gcc-c++

注意：如果yum报错
更换yum源，将原有源删除或备份到别的目下下：
#cd /etc/yum.repos.d/
#wget  http://mirrors.163.com/.help/CentOS6-Base-163.repo
#vi CentOS6-Base-163.repo
编辑文件，把文件里面的$releasever全部替换为版本号6（不是6.5！）最后保存！
vim替换操作：
全部替换：%s/$releasever/6/g 
替换当前行：s/$releasever/6/g 
清除原有缓存，重建缓存： 
#yum clean all 
#yum makecache(不要执行试下)
更新系统： (不要执行试下)
#yum update

二. PCRE pcre-devel 安装
PCRE(Perl Compatible Regular Expressions) 是一个Perl库，包括 perl 兼容的正则表达式库。nginx 的 http 模块使用 pcre 来解析正则表达式，所以需要在 linux 上安装 pcre 库，pcre-devel 是使用 pcre 开发的一个二次开发库。nginx也需要此库。命令：
yum install -y pcre pcre-devel

三. zlib 安装
zlib 库提供了很多种压缩和解压缩的方式， nginx 使用 zlib 对 http 包的内容进行 gzip ，所以需要在 Centos 上安装 zlib 库。
yum install -y zlib zlib-devel

四. OpenSSL 安装
OpenSSL 是一个强大的安全套接字层密码库，囊括主要的密码算法、常用的密钥和证书封装管理功能及 SSL 协议，并提供丰富的应用程序供测试或其它目的使用。
nginx 不仅支持 http 协议，还支持 https（即在ssl协议上传输http），所以需要在 Centos 安装 OpenSSL 库。
yum install -y openssl openssl-devel
~~~





## 2 gogs

```
1 git 工具安装
2 go 环境安装
3 mysql安装
4 添加git 用户（gitdata）
5 下载gogs二进制包
  位置：/home/gitdata/gogs/gogs
      切换用户
          su gitdata
      运行
          /home/gitdata/gogs/gogs web &
      #可能存在权限问题：chown gitdata ~/gogs
      	
6 打开3000端口&&登录http://192.168.1.200:3000
	进行配置（迁移则直接跳过该步骤）
7 根据需要进行配置
	位置：/home/gitdata/gogs/custom/conf/app.ini
```

配置(网页配置后自动出现配置)：

`SSH_ROOT_PATH 	必须填写为 /home/gitdata/.ssh 否则可能导致ssh无法登录root问题`

```
[server]
PROTOCOL = http
DOMAIN = localhost
HTTP_ADDR = 0.0.0.0
HTTP_PORT = 3000
SSH_ROOT_PATH = /home/gitdata/.ssh
```
## 3 gogs 迁移：

```
1 将所有代码  gogs-repositories复制到 /home/gitdata
2 将数据库gogs 导入到目标mysql数据库
管理员  	帐号fgecctv  密码fgecctv4000
```

```
问题：代码可复制但是不能上传 `pre-receive hook declined`
解决：删除每个仓库里的pre-receive 文件
mv gogs-repositories/iot/cloudringad.git/hooks/pre-receive  gogs-repositories/iot/cloudringad.git/hooks/pre-receive.old
```

## 4 Redis安装

```
一、在线安装
yum install redis-server

命令位置
/usr/bin/redis-cli
/usr/bin/redis-server
查找
whereis redis
# usr/local/redis

配置文件
vim /etc/redis.conf
# 不注释掉，远程访问报错：Connection closed by server.
# bind 127.0.0.1
port 6379
logfile /var/log/redis/redis.log #日志文件
dir /var/lib/redis #数据库路径
requirepass 123456 #连接密码

启动方式
  服务器
  #加上`&`号使redis以后台程序方式运行
  redis-server &	
  redis-server
  redis-server /etc/redis.conf --loglevel verbose --port 6379
  客户端
  redis-cli
  redis-cli -h 127.0.0.1 -p 6379 -a 123456
  redis-cli -h 127.0.0.1 -p 6480 -a hm54#fHI#uf --raw
  服务器
  service redis restart
  redis-cli shutdown

二、离线安装：
tar -zxvf redis-4.0.2.tar.gz
#进入解压目录：
cd redis-4.0.2

1.编译
    make	
	异常一：
    make[2]: cc: Command not found
    异常原因：没有安装gcc
    解决方案：yum install gcc-c++
	异常二：
    zmalloc.h:51:31: error: jemalloc/jemalloc.h: No such file or directory
    异常原因：一些编译依赖或原来编译遗留出现的问题
    解决方案：make distclean。清理一下，然后再make。
    
    make test
    在make成功以后，需要。在make test出现异常。
	异常一：
	couldn't execute "tclsh8.5": no such file or directory
	异常原因：没有安装tcl
	解决方案：yum install -y tcl。
	
	redis-benchmark ： 用于测试redis的性能。
    redis-check-aof : 当aof备份文件被损坏，可通过该工具对aof文件进行修复，使用方式：redis-check-aof --fix 要修复的aof文件。
    redis-check-rdb : 修复损坏的rdb备份文件。
    redis-cli : redis客户端，用于连接服务端。
    redis-server ： redis服务器端，用于启动redis服务器。
    redis-sentinel : 哨兵模式（实际使用较多） 在master-slave模式下（slave默认不支持写），当master出现异常时，自动在slave中选择一台作为master。

2.配置文件，redis/src解压目录下
  vim redis.conf
  # 不注释掉，远程访问报错：Connection closed by server.
  # bind 127.0.0.1
  port 6379
  logfile /var/log/redis/redis.log #日志文件
  dir /var/lib/redis #数据库路径
  requirepass 123456 #连接密码

2. 启动，redis解压目录下
  服务器
  redis-server
  redis-server /etc/redis.conf --loglevel verbose --port 6379
  客户端
  redis-cli
  redis-cli -h 127.0.0.1 -p 6379 -a 123456
  redis-cli -h 127.0.0.1 -p 6480 -a hm54#fHI#uf --raw
  服务器
  service redis restart
  
3. 拷贝文件，redis解压目录和src目录下
cp redis.conf /etc/ 这个文件时redis启动的配置文件
cp redis-benchmark redis-cli redis-server /usr/bin/ #这个倒是很有用，这样就不用再执行时加上./了，而且可以在任何地方执行
  

# 检测后台进程是否存在
ps -ef |grep redis
#检测6379端口是否在监听
netstat -lntp | grep 6379

```

## Redis常用命令

~~~
keys *健值*：返回匹配的健
type 健值：返回值的类型


Redis常用命令集
1）连接操作命令
quit：关闭连接（connection）
auth：简单密码认证
help cmd： 查看cmd帮助，例如：help quit

2）持久化
save：将数据同步保存到磁盘
bgsave：将数据异步保存到磁盘
lastsave：返回上次成功将数据保存到磁盘的Unix时戳
shundown：将数据同步保存到磁盘，然后关闭服务

3）远程服务控制
info：提供服务器的信息和统计
monitor：实时转储收到的请求
slaveof：改变复制策略设置
config：在运行时配置Redis服务器

4）对value操作的命令
exists(key)：确认一个key是否存在
del(key)：删除一个key
type(key)：返回值的类型
keys(pattern)：返回满足给定pattern的所有key
randomkey：随机返回key空间的一个
keyrename(oldname, newname)：重命名key
dbsize：返回当前数据库中key的数目
expire：设定一个key的活动时间（s）
ttl：获得一个key的活动时间
select(index)：按索引查询
move(key, dbindex)：移动当前数据库中的key到dbindex数据库
flushdb：删除当前选择数据库中的所有key
flushall：删除所有数据库中的所有key

5）String
set(key, value)：给数据库中名称为key的string赋予值value
get(key)：返回数据库中名称为key的string的value
getset(key, value)：给名称为key的string赋予上一次的value
mget(key1, key2,…, key N)：返回库中多个string的value
setnx(key, value)：添加string，名称为key，值为value
setex(key, time, value)：向库中添加string，设定过期时间time
mset(key N, value N)：批量设置多个string的值
msetnx(key N, value N)：如果所有名称为key i的string都不存在
incr(key)：名称为key的string增1操作
incrby(key, integer)：名称为key的string增加integer
decr(key)：名称为key的string减1操作
decrby(key, integer)：名称为key的string减少integer
append(key, value)：名称为key的string的值附加value
substr(key, start, end)：返回名称为key的string的value的子串

6）List 
rpush(key, value)：在名称为key的list尾添加一个值为value的元素
lpush(key, value)：在名称为key的list头添加一个值为value的 元素
llen(key)：返回名称为key的list的长度
lrange(key, start, end)：返回名称为key的list中start至end之间的元素
ltrim(key, start, end)：截取名称为key的list
lindex(key, index)：返回名称为key的list中index位置的元素
lset(key, index, value)：给名称为key的list中index位置的元素赋值
lrem(key, count, value)：删除count个key的list中值为value的元素
lpop(key)：返回并删除名称为key的list中的首元素
rpop(key)：返回并删除名称为key的list中的尾元素
blpop(key1, key2,… key N, timeout)：lpop命令的block版本。
brpop(key1, key2,… key N, timeout)：rpop的block版本。
rpoplpush(srckey, dstkey)：返回并删除名称为srckey的list的尾元素，并将该元素添加到名称为dstkey的list的头部

7）Set
sadd(key, member)：向名称为key的set中添加元素member
srem(key, member) ：删除名称为key的set中的元素member
spop(key) ：随机返回并删除名称为key的set中一个元素
smove(srckey, dstkey, member) ：移到集合元素
scard(key) ：返回名称为key的set的基数
sismember(key, member) ：member是否是名称为key的set的元素
sinter(key1, key2,…key N) ：求交集
sinterstore(dstkey, (keys)) ：求交集并将交集保存到dstkey的集合
sunion(key1, (keys)) ：求并集
sunionstore(dstkey, (keys)) ：求并集并将并集保存到dstkey的集合
sdiff(key1, (keys)) ：求差集
sdiffstore(dstkey, (keys)) ：求差集并将差集保存到dstkey的集合
smembers(key) ：返回名称为key的set的所有元素
srandmember(key) ：随机返回名称为key的set的一个元素

8）Hash
hset(key, field, value)：向名称为key的hash中添加元素field
hget(key, field)：返回名称为key的hash中field对应的value
hmget(key, (fields))：返回名称为key的hash中field i对应的value
hmset(key, (fields))：向名称为key的hash中添加元素field 
hincrby(key, field, integer)：将名称为key的hash中field的value增加integer
hexists(key, field)：名称为key的hash中是否存在键为field的域
hdel(key, field)：删除名称为key的hash中键为field的域
hlen(key)：返回名称为key的hash中元素个数
hkeys(key)：返回名称为key的hash中所有键
hvals(key)：返回名称为key的hash中所有键对应的value
hgetall(key)：返回名称为key的hash中所有的键（field）及其对应的value


~~~



## 5 nginx安装

```
一、前提、安装编译工具及库文件
详见gcc安装

二、nginx安装
#下载
wget -c https://nginx.org/download/nginx-1.12.1.tar.gz
#解压：
tar -zxvf nginx-1.12.1.tar.gz
#进入解压目录：
cd nginx-1.12.1

1 配置
	./configure 
	或指定安装位置 ./configure --prefix=/usr/local
2 编译、安装
	make
	make install
	或安装到指定目录中 make PREFIX=/usr/local/nginx install
3 查找
	whereis nginx
	# usr/local/nginx/sbin
4 启动
	cd /usr/local/nginx
	./nginx
    ./nginx -s stop       # kill
    ./nginx -s quit       # 等待nginx处理完任务后停止
    ./nginx -t            # 测试conf文件
    ./nginx -s reload     # 可以更新配置
	nginx
	nginx -s stop		# kill
	nginx -s quit		# 等待nginx处理完任务后停止
	nginx -t            # 测试conf文件
	nginx -s reload 	# 可以更新配置
5 重启：先停止再启动
	nginx -s quit
	nginx 
6 开机启动
	vi /etc/rc.local 添加一行 /etc/rc.d/rc.local的链接
	/usr/local/nginx/sbin/nginx
	chmod 755 rc.local
7 配置  
vim /etc/nginx/nginx.conf
/usr/local/nginx/sbin/nginx -s quit
/usr/local/nginx/sbin/nginx /etc/nginx/nginx.conf   
```



~~~
user  root;
worker_processes  6;

error_log  /home/appuser/app/logs/nginx/error.log;
error_log  /home/appuser/app/logs/nginx/error.log  notice;
error_log  /home/appuser/app/logs/nginx/error.log  info;

#pid        logs/nginx.pid;


events {
    worker_connections  1024;
}


http {
    include       mime.types;
    default_type  application/octet-stream;

    charset utf-8;
    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    access_log  /home/appuser/app/logs/nginx/access.log  main;

    sendfile        on;
    #tcp_nopush     on;

    #keepalive_timeout  0;
    keepalive_timeout  65;

    #开启Gzip压缩
    gzip  on;
    #不压缩临界值，大于1k的才压缩，一般不用改
    gzip_min_length 1k;
    ##buffer相关设置
    gzip_buffers 4 16;
    ##用了反向代理的话，末端通信是HTTP/1.0,默认是Http/1.1
    #gzip_http_version 1.0;
    ##压缩级别，1~10，数字越大压缩的越好，时间也越长
    gzip_comp_level 3;
    ##进行压缩的文件类型，缺啥补啥就行了，JavaScript有两种写法，最好都写上吧，总有人抱怨js文件没有压缩，其实多写一种格式就行了
    gzip_types text/plain application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;
    ##跟Squid等缓存服务有关，on的话会在Header里增加"Vary: Accept-Encoding"，我不需要这玩意，自己对照情况看着办吧
    gzip_vary off;
    ##IE6对Gzip不怎么友好，不给它Gzip了
    gzip_disable "MSIE [1-6]\.";

    ##cache begin######
    proxy_connect_timeout 5;
    proxy_read_timeout 60;
    proxy_send_timeout 5;
    proxy_buffer_size 16k;
    proxy_buffers 4 64k;
    proxy_busy_buffers_size 128k;
    proxy_temp_file_write_size 128k;
    ###设置临时目录
    proxy_temp_path /home/appuser/data/nginx_cache/temp;
    ###设置缓存目录为二级目录
    proxy_cache_path /home/appuser/data/nginx_cache/cache levels=1:2 keys_zone=cache_one:200m inactive=1d max_size=30g;
    
    upstream tomcat-host {
        ip_hash;
        server 172.16.32.7:9001 weight=1;
    }

    server {
        listen       80;
        server_name  knowledge.hmrkbs.com;

        #charset koi8-r;
        #access_log  logs/host.access.log  main;
		
		root /home/appuser/upload;
		
        location / {
            root   html;
            index  index.html index.htm ;
            proxy_pass      http://tomcat-host;
            client_max_body_size  200m;
	        proxy_redirect 	    off;
            proxy_set_header        X-Real-IP $remote_addr;
            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header        Host $http_host;
            #proxy_cache cache_one;
            #proxy_cache_valid 200 304 12h;
            #proxy_cache_valid any 1m;
        }
			
		location ~ ^/(images|file|temp)/  {
         	root        /home/appuser/upload;
          	access_log  off;
          	expires     30d;
        }
	
server {
        listen 443 ssl;
        server_name knowledge.hmrkbs.com; 
        ssl on;
        ssl_certificate /home/appuser/app/ssl/1_knowledge.hmrkbs.com_bundle.crt;
        ssl_certificate_key /home/appuser/app/ssl/2_knowledge.hmrkbs.com.key;
        ssl_session_timeout 5m;
        ssl_protocols TLSv1 TLSv1.1 TLSv1.2; 
        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;
        ssl_prefer_server_ciphers on;
		
		
    	root /home/appuser/upload;
		
        location / {
            root   html;
            index  index.html index.htm ;
            proxy_pass      https://172.16.32.7:8443;
            client_max_body_size  200m;
	        proxy_redirect 	    off;
            proxy_set_header        X-Real-IP $remote_addr;
            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header        Host $http_host;
            #proxy_cache cache_one;
            #proxy_cache_valid 200 304 12h;
            #proxy_cache_valid any 1m;
        }
	
		
		location ~ ^/(images|file|temp)/  {
         	root        /home/appuser/upload;
          	access_log  off;
          	expires     30d;
        }

		location /sign_in  {
			proxy_pass    http://118.126.91.140:8888/sign_in;
        }
		
		location /sign_out  {
			proxy_pass    http://118.126.91.140:8888/sign_out;
        }
		
		location /message  {
			proxy_pass    http://118.126.91.140:8888/message;
        }
		
	 	location /wait   {
			proxy_pass    http://118.126.91.140:8888/wait;
        }

		location /ws {
			proxy_pass http://172.16.32.7:61614; 
			proxy_http_version 1.1;
			proxy_set_header Upgrade $http_upgrade;
			proxy_set_header Connection 'Upgrade';
		}
	
    }
}

~~~



## Tomcat配置https

~~~~
一、先使用JDK自带的加密工具生成一对秘钥文件

进入JDK的bin目录下，打开命令行工具，输入
keytool -genkeypair -alias "tomcat" -keyalg "RSA" -keystore "D:\ssl\tomcat.keystore" 

密钥库口令:123456（这个密码非常重要）
名字与姓氏:192.168.0.110（以后访问的域名或IP地址，非常重要，证书和域名或IP绑定）
组织单位名称:anything（随便填）
组织名称:anything（随便填）
城市:anything（随便填）
省市自治区:anything（随便填）
国家地区代码:anything（随便填）

这样就会生成一对秘钥文件。

keytool -importkeystore -srckeystore D:\ssl\tomcat.keystore -destkeystore D:\ssl\tomcat.keystore -deststoretype pkcs12

二、通过tomcat的连接器将秘钥文件连接到tomcat中。

在tomcat的安装根目录下新建文件夹ssl，将秘钥文件复制到该文件夹中，打开conf文件夹下的server.xml文件，将找到下面的一段注释掉的内容：
<!--
    <Connector port="8443" protocol="org.apache.coyote.http11.Http11NioProtocol"
               maxThreads="150" SSLEnabled="true" scheme="https" secure="true"
               clientAuth="false" sslProtocol="TLS" />
    -->
　　更改如下：
<Connector port="8443" protocol="org.apache.coyote.http11.Http11NioProtocol"
               maxThreads="150" SSLEnabled="true" scheme="https" secure="true"
               clientAuth="false" sslProtocol="TLS"
               keystoreFile="D:\ssl\tomcat.keystore" 
               keystorePass="123456" />


~~~~





## nginx配置https

~~~
一、生产证书
cd /usr/local/nginx
mkdir ssl
1、创建私钥
openssl genrsa -des3 -out test.key 1024 //创建自身密钥 本地的虚拟机环境,1024够了,要是你想要更高的,就*2*2吧....输入密码后，再次重复输入确认密码。记住此密码，后面会用到。

2、创建csr证书
openssl req -new -key test.key -out test.csr  //通过密钥生成相应CSR申请文件 正规要钱的就要拿着这玩意去申请了,其中key文件为刚才生成的文件。
执行上述命令后，需要输入一系列的信息。输入的信息中最重要的为Common Name，这里输入的域名即为我们要使用https访问的域名 ，比如我输入的是localhost。其它的内容随便填即可。以上步骤完成后，ssl文件夹内出现两个文件：server.csr 和 server.key

3、去除密码。
在加载SSL支持的Nginx并使用上述私钥时除去必须的口令，否则会在启动nginx的时候需要输入密码。
复制test.key并重命名为test.key.org。
cp test.key test.key.org
在命令行中执行如下命令以去除口令：
openssl rsa -in test.key.org -out test.key

4.生成crt证书
openssl x509 -req -days 365 -in test.csr -signkey test.key -out test.crt//生成证书


二、nginx配置
server {
    listen       443 ssl;
    server_name  localhost;

    ssl_certificate      D://nginx//ssl//test.crt;  # 这个是证书的crt文件所在目录
    ssl_certificate_key  D://nginx//ssl//test.key;  # 这个是证书key文件所在目录

    ssl_session_cache    shared:SSL:1m;
    ssl_session_timeout  5m;

    ssl_ciphers  HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers  on;

    location / {
      root   html;                  # 这个是指定一个项目所在目录
      index  index.html index.htm;  # 这个是指定首页的文件名
    }
}

三.tomcat增加对https协议的支持
1.Connector节点加入 redirectPort="443" proxyPort="443"
2.加入新的Value节点 <Valve className="org.apache.catalina.valves.RemoteIpValve"
remoteIpHeader="x-forwarded-for"
remoteIpProxiesHeader="x-forwarded-by"
protocolHeader="x-forwarded-proto"/>

~~~





## 6 mount

将整块磁盘1T mount到系统上

查看文件系统是否已挂载
df -h

xiao@xc:~/模板$  sudo mount /dev/sda /mnt/disk/

mount: wrong fs type, bad option, bad superblock on /dev/sda,

       missing codepage or helper program, or other error
       In some cases useful info is found in syslog - try
       dmesg | tail or so.


##  8 emqtt 安装

```
http://www.emqtt.io/downloads/latest/centos7-rpm
rpm -ivh --force emqttd-centos7-v2.3-beta.3-1.el7.centos.x86_64.rpm 
vim /etc/emqttd/emq.conf
dashboard:http://192.168.1.200:18083
emqttd console # 可以看到各种端口

dashboard:http listen on 0.0.0.0:18083 with 2 acceptors.
mqtt:tcp listen on 127.0.0.1:11883 with 16 acceptors.
mqtt:tcp listen on 0.0.0.0:1883 with 16 acceptors.
mqtt:ws listen on 0.0.0.0:8083 with 4 acceptors.
mqtt:ssl listen on 0.0.0.0:8883 with 16 acceptors.
mqtt:wss listen on 0.0.0.0:8084 with 4 acceptors.
mqtt:api listen on 127.0.0.1:8080 with 4 acceptors.

# 端口修改
306 listener.tcp.external = 0.0.0.0:1885

# 配置：/etc/emqttd
# 日志 
/var/log/emqttd/
```



## 9 iptables 防火墙配置

```
敲黑板： 防火墙开好了端口一定要看下服务是不是绑定了本地，比如supervisor, mongo这些
filter链：根据数据包的分析资料”对比”预先定义的规则内容，若数据包数据与规则内容相同则进行动作，否则就继续下一条规则的比对。所以位置很重要
[root@localhost ~]# vim /etc/sysconfig/iptables
[root@localhost ~]# service iptables restart
Redirecting to /bin/systemctl restart  iptables.service
修改配置，重启over
```

```
iptables-restore < /etc/iptables.rules
service iptables restart
```

```
iptables -A INPUT -p tcp --dport 20 -j ACCEPT 
iptables -I INPUT -p tcp --dport 4000:5000 -j ACCEPT 
```

```
1 链管理命令：
	-P 设置默认策略： iptables -P INPUT DROP 把默认对则拒绝，所有远程连接都被拒绝
    -F 清空规则链 ： iptables -t nat -F PREROUTING
    				iptables -t noat -F 清空nat表的所有链
    -N 支持用户新建一个链：iptables -N inbound_tcp_web 
    -X 删除用户自定义链
    -E 自定义链重命名
    -Z 清空链即链中默认规则的额计算器
    
2 规则管理：-A 追加  -I 3 插入到第三行  -R 3 取代第三行  -D 3 删除
iptables -I 16 INPUT -p tcp --dport 9001 -j ACCEPT
iptables -I INPUT -s 0.0.0.0/0 -p tcp --dport 9001 -j ACCEPT 
3 查看管理命令 -L
	-n 数字显示 -v 详细显示 -vv -vvv
	-x 在计数器上显示精确值，不做单位换算
	--line-numbers 显示规则行号
	-t nat:显示所有的关卡信息
```

```
1 通用匹配：源地址目标地址的匹配
	-s :指定作为源地址匹配，这里不能指定主机名称，必须是IP | IP/MASK|0.0.0.0/0.0.0.0
		而且地址可以去翻，加一个！ 表示除了哪个ip之外
	-d: 目标地址
	-p: 匹配协议 TCP/UDP/ICMP
	-i eth0: 从这块网卡流入的数据
		流入一般用在INPUT PREROUTING
	-o eth0: 从这块网卡流出的数据
		OUTPUT POSTROUTING
2 扩展匹配 隐含扩展
-p tcp --dport xx-xx: 指定目标端口或连续端口
-p tcp --sport: 指定源端口
--tcp-flags : tcp的标志位 SYN ACK FIN PSH RST URG
--tcp-flags syn,ack,fin,rst syn  = --syn
	# 表示检查这厮个标志位，syn必须为1,其余为0,表示三次握手第一次包
-p udp --dport/--sport
-p icmp: 
3 显式匹配
-m multiport --dport 21,23,80
```

```
-j ACTION
DROP: 悄悄丢弃
REJECT： 拒绝
ACCEPT： 接受
DNAT
SNAT
MASQUERADE： 源地址伪装
REDIRECT 重定向：主要用于实现端口重定向
MARK： 打防火墙标记
RETURN 返回
```



## 10 开机启动配置



```
在centos7中,/etc/rc.d/rc.local文件的权限被降低了,没有执行权限,需要给它添加可执行权限。
chmod +x /etc/rc.d/rc.local
然后就可以在里面添加你要开机自启的命令了
vim /etc/rc.d/rc.local

/usr/local/nginx/sbin/nginx &
/usr/local/mongodb/bin/mongod --config /usr/local/mongodb/bin/mongodb.conf &
/home/git/gogs/gogs web &
```



## 11 python

```
1 pip 安装
  yum install python-pip
  # 如果python-pip 不存在，使用yum -y install epel-release
  pip install --upgrade pip
  pip install -r requirements.py
```

```
2 MySQLdb 安装
  # yum install python-devel mysql-devel zlib-devel openssl-devel
  pip install mysql-python
3 connector 安装
  # pip install mysql-connector
  # sudo yum install mysql-connector-python-rf
  pip install mysql-connector==2.1.4
```

## 12 pip

```
pip freeze > requirements.txt
pip install -r requirements.txt
```



## 14 superivor

```
yum install supervisor
vim /etc/supervisord.conf 去掉注释
[inet_http_server]         ; inet (TCP) server disabled by default
port=127.0.0.1:9001        ; (ip_address:port specifier, *:port for all iface)
username=user              ; (default is no username (open server))
password=123               ; (default is no password (open server))

 ; 修改127.0.0.1:9001  为 0.0.0.0：9001
```

```
vim /etc/supervisord.d/cloudring_cn.conf  # 添加应用
[program:userserver_cn]
command=python /ali/cloudring_cn/userserver/server.py
autostart=true
autorestart=true
autostart=true
startsecs=5
startretries=10000
redirect_stderr=true
stopasgroup=true
killasgroup=true
stdout_logfile=/ali/supervisor/log/userserver_cn/shutdown.log
stdout_logfile_maxbytes=10MB
```

```
supervisord # 开启服务
supervisorctl reload
supervisorctl start all/appname
supervisorctl stop all/appname
```



## 15 scp

```
scp -P62 -r fgeuser@120.76.214.91/ali/supervisor .
```



##16 SELinux

```
 该服务与较多服务冲突，使用繁琐，建议关闭
 1 查看状态/usr/sbin/sestatus -v  
 2 设置为 permissive: setenforce 0
 3 修改/etc/selinux/config 文件
	将SELINUX=enforcing改为SELINUX=disabled
	重启机器即可
```



##17 XXX

```

```



## 19 jenkins

```
用户名： xiao
密码： 1992
vim .jenkins/secrets/initialAdminPassword
---------------
tomcat:启动
./startup.sh
./shutdown.sh
ps -ef |grep java
/etc/init.d/iptables status

1、下载tomcat
2、下载jenkins：http://updates.jenkins-ci.org/download/war/
3、unzip tomcat
4、将jenkins.war放到tomcat\webapps下
5、tomcat\bin\startup.sh启动tomcat：./startup.sh
注：Linux中新添加的文件需添加执行权限，cd到tomcat\bin：chmod+x *
6、启动成功后登录：http://127.0.0.1:8080/jenkins
-jenkins初始化密码:
	位置:/home/xiao/.jenkins/secrets/initialAdminPassword
-安装插件
```

**构建配置**

```
1 登录
帐号  admin
密码  vim .jenkins/secrets/initialAdminPassword

2 新建 -》 构建一个自由风格的软件项目
3 源码管理：
	配置仓库url, 帐号密码，相应分支。
4 构建 -》 Execute shell
#!/bin/bash
echo "==================================="
echo "======python automatic script======"
echo "==================================="

cd /ali/cloudring_cn/
git pull
if [ $? -ne 0 ]; then
#echo "cloudring_cn command failed!!!  $time"  >>  /home/jenkins/jenkins.log
exit 1
else
echo "========================================="
echo "git pull ===[/home/cloudring_cn]=== ok!!!"
echo "========================================="
#echo "git pull cloudring_cn ok!!!  $time"  >>  /home/jenkins/jenkins.log
fi

5 一般root用户执行该指令，需要将root的公钥加入git服务器的
~/.ssh/authorized_keys中, 否则 pull会失败
```

## 20 git

```
git remote add origin https://github.com/xiaowenlong100/dj-mysite-polls.git
git push -u origin master

# 填好公钥后仍需要密码
	
# 路径不全导致代码拉取失败
git clone gitdata@192.168.1.200:/home/gitdata/gogs-repositories/python/cloudring.git
gitdata@192.168.1.200:python/cloudring.git


# 本地拉取远程非master分支
git checkout -b release origin/release
```



## 22 telnet centos7

```
1 安装
	yum -y install xinetd telnet telnet-server  
2 允许root帐号登录
	vi /etc/securetty
	#添加两行
	pts/0  
	pts/1 
3 添加防火墙
	vi /etc/sysconfig/iptables  
    -A INPUT -p tcp -m state --state NEW -m tcp --dport 23 -j ACCEPT  
4 重启服务，关闭firewalld
    systemctl restart iptables  
    systemctl disable firewalld  
    systemctl stop firewalld 
5 注册服务
    systemctl enable telnet.socket  
    systemctl start telnet.socket  
    systemctl enable xinetd  
    systemctl start xinetd 
6 测试
	telnet localhost
```





## 23 WebRTC

~~~~
1.信令服务器部署（端口号8888）：
 Windows版本： 运行下面exe服务程序 
 peerconnection_server.exe
 peerconnection_server.exe -port 8889
 
 Linux版本:   运行下面服务程序
 命令 ./peerconnection_server (-port 8889)
 可能权限不够 chomd 777 peerconnection_server

~~~~

~~~
2.turn服务器部署（转发服务器 默认端口3478）
2.1 安装turn服务器先决条件
     yum install -y make gcc cc gcc-c++ wget
     yum install -y openssl-devel libevent libevent-devel mysql-devel mysql-server

注：可能libevent安装失败可以手动下载安装地址如下
 wget https://github.com/downloads/libevent/libevent/libevent-2.0.21-stable.tar.gz

2.2 下载和安装TURN模块
       下载turn服务器程序（如下载不下，下面有文件）
wget http://turnserver.open-sys.org/downloads/v4.4.5.2/turnserver-4.4.5.2.tar.gz
          
        编译turn-server
        tar -zxvf rfc5766-turn-server-3.2.5.9.tar.gz
cd rfc5766-turn-server-3.2.5.9
./configure 
make
make install

2.3	修改配置文件 turnserver.conf 
cp /usr/local/etc/turnserver.conf.default   /etc/turnserver.conf vi /etc/turnserver.conf 
#监听端口可以不设置为默认的3478
listening-port=3478
#listening-ip,注意必须是你的内网IP地址如(如果你是阿里云的，就是私网地址）：
listening-ip=172.16.32.7
#relay-ip可以不设置，默认会使用你的外网ip地址作为转发包的中继地址
#external-ip，注意必须使用你的外网IP地址如：
external-ip=118.126.91.140
#设置用户名及密码，这个是作为TURN服务器使用必须设置的,可以设置多个， 
user=user:hm88888888

2.4	运行TURN服务
   nohup turnserver -v -r  118.126.91.140:3478 -a -o -c /etc/turnserver.conf > /dev/null &

     turnserver -v -r  118.126.91.140:3478 -a -o -c /etc/turnserver.conf

~~~



## oracle安装

~~~
1、将安装文件拷贝到oracle目录下
linux.x64_11gR2_database_1of2.zip  linux.x64_11gR2_database_2of2.zip

2、解压
[oracle@zhufukun oracle]$ unzip linux.x64_11gR2_database_1of2.zip
[oracle@zhufukun oracle]$ unzip linux.x64_11gR2_database_2of2.zip

3、进入database目录
[oracle@zhufukun database]$ ./runInstaller

[oracle@zhufukun database]$ ./runInstaller 
正在启动 Oracle Universal Installer...
检查临时空间: 必须大于 120 MB。   实际为 6270 MB    通过
检查交换空间: 必须大于 150 MB。   实际为 2047 MB    通过
检查监视器: 监视器配置至少必须显示 256 种颜色
    >>> 无法使用命令 /usr/bin/xdpyinfo 自动检查显示器颜色。请检查是否设置了 DISPLAY 变量。    未通过 <<<<

未通过某些要求检查。必须先满足这些 要求, 
然后才能继续安装,
是否继续? (y/n) [n] 

因为使用了SSH软件操作（该软件在Windows操作系统下，那么需要设置DISPLAY环境变量和Xming软件一块将安装的图形界面调出来。
使用export DISPLAY=Windows操作系统IP:0.0(同步打开Xming软件)，有些情况不需要进行该步骤设置。

[oracle@zhufukun database]$ echo $DISPLAY
[oracle@zhufukun database]$	export DISPLAY=192.168.50.230:0.0
[oracle@zhufukun database]$ xhost +
[oracle@zhufukun database]$ export DISPLAY=:0

用root用户
[root@zhufukun ~]# echo $DISPLAY
[root@zhufukun ~]# export DISPLAY=192.168.50.230:0.0
[root@zhufukun ~]# xhost +
[root@zhufukun ~]# export DISPLAY=:0
当出现“clents can connect from any host”时，即可以将数据库安装界面调出来。
[root@zhufukun ~]#xdpyinfo 记录下name of display：后的字符串，如 127.0.0.1：1.0
~~~



## oracle连接及SQL

~~~
>sqlplus /nolog
>connect sys/sys@127.0.0.1:1521/orcl as sysdba
>connect system/system@192.168.1.109:1521/ora11g
sql> alter user sys identified by zfk;
sql>disconnect

#创建实例

查数据库编码
select * from nls_database_parameters where parameter='NLS_CHARACTERSET';
AL32UTF8
select userenv('language') from dual;
AMERICAN_AMERICA.AL32UTF8
环境变量NLS_LANG= AMERICAN_AMERICA.AL32UTF8



--以下皆在sys用户下操作
创建用户 
sql>create user 用户名 identified by 密码;
修改用户密码
sql>alter user 用户名 identified by 密码;
删除用户 
sql>drop user 用户名 【cascade】;
授管理员权限 
授用户无限表空间权限 
sql>grant unlinmited tablespace to 用户名; 
sql>grant dba to 用户名; 
收回管理员权限 
sql>revoke dba from 用户名
授登录（权限角色） 
sql>grant connect to 用户名 
授resource（权限角色）
sql>grant resource to 用户名 
创建表空间的数据文件
sql>create tablespace ZFK_TS datafile 'd:\oracle\binbo.dbf' size 10m; 
选择表空间
sql>alter user 用户名 default tablespace ZFK_TS


查看当前用户的角色（权限） 
SQL>select * from user_role_privs;
查看当前用户的系统权限和表级权限 
SQL>select * from user_sys_privs; 
SQL>select * from user_tab_privs;
查看当前用户的缺省表空间 
SQL>select username,default_tablespace from user_users;


 (1)t1表的设备类型sblx的列的数据编码bm在t2表中有对应的名称
select (select t2.mc from t_ggdm t2 where t2.bm=t1.sblx) sblx from t_sb t1;
(2)oracle分页查询
select * from (select t.*,rownum n from zfk_friend_user t) where n between ? and ?
(2)分组排序取每组前几
select b.*
  from 
  (select row_number() over(partition by type order by id desc) rn, a.* from ww_xzzqb a) b
 where rn <= 2;
(3)后台递归查询
(a)select distinct zybm,zymc,sjzy,jdlx,jmbq from t_afyy_zyxxb t  start with t.zymc like '%"+nodeName+"%'  connect by prior sjzy=zybm order by zybm
(b) select distinct zybm,zymc,sjzy,jdlx,jmbq,sblx from 
(select * from t_afyy_zyxxb t where t.sblx> 8 or t.sblx is null ) a
  start with a.zymc like '%南%' connect by prior sjzy=zybm order by zybm
(4)添加一列
alter table t_afyy_gjxxb add clzt varchar2(2);
(5)行转列
select t.countryid,
       (select c.country_area_chinese
          from ges_4e_country c
         where c.id = t.countryid),
       sum(decode(t.time, '2012', t.value, 0)) as t2012,
       sum(decode(t.time, '2013', t.value, 0)) as t2013,
       sum(decode(t.time, '2014', t.value, 0)) as t2014
  from ges_4e_data_electric t  group by t.countryid; 

(6)删除重复数据
delete from ges_data_import_detail
 where (history_id, file_name) in
       (SELECT history_id, file_name
          FROM ges_data_import_detail
         GROUP BY history_id, file_name
        HAVING COUNT(*) > 1)
   and rowid not in (select min(rowid)
                       from ges_data_import_detail
                      group by history_id, file_name
                     having count(*) > 1)
(5)修改设置列的默认生成值
alter table t_afyy_gjxxb modify clzt default('00');
(6)修改字段长度
alter table t_afyy_rzxxb modify rzid varchar2(32);
(7)给表列添加备注
comment on column T_AFYY_RZXXB.RZID is '日志ID';
(8)3张表的连接查询
select b.weekid,c.qssj,c.zzsj,c.sjdid from 
t_afyy_sjmbb a,t_afyy_bfsjb b,t_afyy_sjdb c 
where a.sjmbid=b.sjmbid and b.id = c.bfsjid
 	and a.sjmbid ='EB58EF9C-E985-4874-64E8-1F33BBD4';

~~~









# 192.168.1.28 ubuntu 

## 1 nginx安装

```
一. 安装gcc依赖库
sudo apt-get install build-essential
sudo apt-get install libtool

二. 安装pcre依赖库 
PCRE(Perl Compatible Regular Expressions) 是一个Perl库，包括 perl 兼容的正则表达式库。nginx 的 http 模块使用 pcre 来解析正则表达式，所以需要在 linux 上安装 pcre 库，pcre-devel 是使用 pcre 开发的一个二次开发库。nginx也需要此库。命令：
sudo apt-get update
sudo apt-get install libpcre3 libpcre3-dev

三. 安装zlib 依赖库
zlib 库提供了很多种压缩和解压缩的方式， nginx 使用 zlib 对 http 包的内容进行 gzip ，所以需要在 Centos 上安装 zlib 库。
sudo apt-get install zlib1g-dev

四. 安装OpenSSL依赖库
OpenSSL 是一个强大的安全套接字层密码库，囊括主要的密码算法、常用的密钥和证书封装管理功能及 SSL 协议，并提供丰富的应用程序供测试或其它目的使用。
nginx 不仅支持 http 协议，还支持 https（即在ssl协议上传输http），所以需要在 Centos 安装 OpenSSL 库。
sudo apt-get install openssl

五、nginx安装
#下载最新版本：
wget http://nginx.org/download/nginx-1.11.3.tar.gz
#解压：
tar -zxvf nginx-1.11.3.tar.gz
#进入解压目录：
cd nginx-1.11.3

1 配置
    ./configure 
2 编译
    make
    make install
3 查找
    whereis nginx
    # usr/local/nginx
4 启动
cd  /usr/local/nginx/sbin
    ./nginx
    ./nginx -s stop       # kill
    ./nginx -s quit       # 等待nginx处理完任务后停止
    ./nginx -t            # 测试conf文件
    ./nginx -s reload     # 可以更新配置
5 重启：先停止再启动
    ./nginx -s quit
    ./nginx 
6 开机启动
    vi /etc/rc.local 添加一行 /etc/rc.d/rc.local的链接
    /usr/local/nginx/sbin/nginx
    chmod 755 rc.local
7 配置  
vim /etc/nginx/nginx.conf

```





## 2 FTP

~~~
sudo apt install vsftpd

service vsftpd start
service vsftpd stop
~~~



## 3 Redis

~~~
sudo apt install redis-server

# 命令位置
/usr/bin/redis-cli
/usr/bin/redis-server

vim /etc/redis.conf
# 不注释掉，远程访问报错：Connection closed by server.
# bind 127.0.0.1
port 6379
logfile /var/log/redis/redis.log
dir /var/lib/redis # 数据库
requirepass 123456

#检测后台进程是否存在
ps -ef |grep redis
#检测6379端口是否在监听
netstat -lntp | grep 6379

kill -9 pid

# 启动方式
#加上`&`号使redis以后台程序方式运行
redis-server &
redis-server
redis-server /etc/redis.conf --loglevel verbose --port 6379
redis-cli
redis-cli -h 127.0.0.1 -p 6379 -a 123456
redis-cli shutdown
~~~



## 4 mongodb

```
192.168.1.28 workway HeMei457@#
sudo mongod --config /etc/mongod.conf  
mongo 192.168.1.28:27017

vim /etc/mongodb/mongo.conf
dbpath = /etc/mongodb/db
logpath = /etc/mongodb/log/mongodb.log

mkdir /etc/mongodb/db
mkdir /etc/mongodb/log
启动
mongod --config=/etc/mongodb/mongo.conf --logappend --fork

验证
client = pymongo.MongoClient(
    host="192.168.1.28",
)
db = client.get_database("xiao")
if not db.get_collection('xiao'):
    db.create_collection("a_collection")
coll = db.get_collection('xiao')
print('result: {}'.format(coll.insert_one({"a": "abc"})))

mongo 客户端:
show dbs
use xiao
show collections
db.xiao.find()
```



## 5 VPN

~~~
sudo apt-get install ppp iptables pptpd

A：编辑pptpd.conf：
输入：vi /etc/pptpd.conf
找到localip，去掉下面字段前面的#，然后保存退出。
localip 192.168.0.1
remoteip 192.168.0.234-238,192.168.0.245

编辑options.pptpd
vi /etc/ppp/options.pptpd
搜索ms-dns，去掉搜索到的两行ms-dns前面的#，并修改为下面的字段
ms-dns 8.8.8.8
ms-dns 8.8.4.4
然后是加入VPN的帐号密码，需要编辑/etc/ppp/chap-secrets设置：
vi /etc/ppp/chap-secrets
添加一行，按照下面格式输入：
# client        server  secret                  IP addresses
用户名 pptpd 密码 *
zfk   pptpd   123456  *
保存退出，配置内核。
vi /etc/sysctl.conf
在这个文件里面加入一行：net.ipv4.ip_forward=1，然后保存退出。
输入：sysctl -p 让刚才的设置生效。
输入：iptables -t nat -A POSTROUTING -s 192.168.0.0/24 -j SNAT --to-source 你的硅谷服务器的公网IP。
请注意最后的参数并不是那一段中文哦，而是你的服务器的IP地址。去阿里云的管理平台看。

然后输入：chmod +x /etc/rc.d/rc.local
编辑系统配置：vi /etc/rc.d/rc.local
把刚才那个iptables的命令加入进去。保存退出。
启动vpn链接的服务：systemctl start pptpd
service pptpd start #启动pptp
/etc/init.d/pptpd stop #关闭
service pptpd restart #重启
让它开机自启动：
chkconfig pptpd on
万事大吉，整个过程大概30分钟就能搞定。
之后的VPN设置也很容易，你有了IP地址和用户名密码，直接设置好了就行。

~~~





























